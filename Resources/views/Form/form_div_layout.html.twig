{% block form_group %}
    {% spaceless %}
    <fieldset id="{{ group }}">
        <legend>{{ group_name|trans({}, translation_domain) }}</legend>
        {% for element_name in elements %}
            {% if form[element_name] is defined %}
                {{ form_row(form[element_name]) }}
            {% endif %}
        {% endfor %}
    </fieldset>
    {% endspaceless %}
{% endblock %}

{% block form_rows %}
    {% spaceless %}
        {% for group, group_elements in form.vars.groups %}
            {{ form_group(form, {'group': group, 'group_name': form.vars.groups_names[group] , 'elements' : group_elements}) }}
        {% endfor %}
    {% endspaceless %}
{% endblock form_rows %}

{% block ckeditor_widget %}
    {% spaceless %}
    <textarea {{ block('widget_attributes') }}>{{ value }}</textarea>

    <script type="text/javascript">
        var CKEDITOR_BASEPATH = '{{ app.request.basePath ~ '/bundles/fsiformextensions/ckeditor/' | raw }}';
    </script>

    {{ include_ckeditor() }}

    <script type="text/javascript">
        {% autoescape true %}
        CKEDITOR.replace("{{ id }}", {
            ui_color: '{{  form.vars.ckeditor_config.ui_color }}',
            forcePasteAsPlainText: {{ form.vars.ckeditor_config.force_paste_as_plaintext }},
            language: '{{ form.vars.ckeditor_config.language }}',
            toolbar: {{ form.vars.ckeditor_config.toolbar | json_encode | raw }},
            {% if form.vars.ckeditor_config.width is not null %}
            width: '{{ form.vars.ckeditor_config.width }}',
            {% endif %}
            {% if form.vars.ckeditor_config.height is not null %}
            height: '{{ form.vars.ckeditor_config.height }}',
            {% endif %}
            {% if form.vars.ckeditor_config.skin is not null %}
            skin: '{{ form.vars.ckeditor_config.skin }}',
            {% endif %}
            {% if form.vars.ckeditor_config.base_href is null %}
            baseHref: '{{ app.request.scheme ~ '://' ~ app.request.httpHost ~ app.request.basePath }}',
            {% else %}
            baseHref: '{{ form.vars.ckeditor_config.base_href }}',
            {% endif %}
            {% if form.vars.ckeditor_config.body_class is not null %}
            bodyClass: '{{ form.vars.ckeditor_config.body_class }}',
            {% endif %}
            {% if form.vars.ckeditor_config.body_id is not null %}
            bodyId: '{{ form.vars.ckeditor_config.body_id }}',
            {% endif %}
            {% if form.vars.ckeditor_config.enter_mode is not null %}
            enterMode: CKEDITOR.{{ form.vars.ckeditor_config.enter_mode }},
            {% endif %}
        });
        {% endautoescape %}
    </script>
    {% endspaceless %}
{% endblock %}